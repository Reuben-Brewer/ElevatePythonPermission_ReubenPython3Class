# -*- coding: utf-8 -*-

'''
Reuben Brewer, Ph.D.
reuben.brewer@gmail.com
www.reubotics.com

Apache 2 License
Software Revision B, 12/29/2025

Verified working on: Python 3.12/13 for Windows 10/11 64-bit.
'''

__author__ = 'reuben.brewer'

##########################################################################################################
##########################################################################################################

###########################################################
import ReubenGithubCodeModulePaths #Replaces the need to have "ReubenGithubCodeModulePaths.pth" within "C:\Anaconda3\Lib\site-packages".
ReubenGithubCodeModulePaths.Enable()
###########################################################

###########################################################
from ElevatePythonPermission_ReubenPython3Class import *
###########################################################

###########################################################
import os
import sys
import platform
import time
import datetime
import traceback
import subprocess
import keyboard
###########################################################

##########################################################################################################
##########################################################################################################

##########################################################################################################
##########################################################################################################
def ExitProgram_Callback(OptionalArugment = 0):
    global EXIT_PROGRAM_FLAG

    print("ExitProgram_Callback event fired!")

    EXIT_PROGRAM_FLAG = 1
##########################################################################################################
##########################################################################################################

##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
if __name__ == '__main__':

    ##########################################################################################################
    ##########################################################################################################
    global EXIT_PROGRAM_FLAG
    EXIT_PROGRAM_FLAG = 0

    global USE_KEYBOARD_FLAG
    USE_KEYBOARD_FLAG = 1

    global USE_ElevatePythonPermission_FLAG
    USE_ElevatePythonPermission_FLAG = 1
    ##########################################################################################################
    ##########################################################################################################

    ##########################################################################################################
    ##########################################################################################################
    if USE_KEYBOARD_FLAG == 1 and EXIT_PROGRAM_FLAG == 0:
        keyboard.on_press_key("esc", ExitProgram_Callback)
    ##########################################################################################################
    ##########################################################################################################

    ##########################################################################################################
    ##########################################################################################################
    if USE_ElevatePythonPermission_FLAG == 1:
        try:
            print("Starting main loop for test_program_for_ElevatePythonPermission_ReubenPython3Class.py...")
            ElevatePythonPermission_ReubenPython3Class.RunPythonAsAdmin()

        except:
            exceptions = sys.exc_info()[0]
            print("Exceptions: %s" % exceptions)
            traceback.print_exc()
    ##########################################################################################################
    ##########################################################################################################

    ##########################################################################################################
    ##########################################################################################################
    try:
        #shell_command_to_issue = "C:\\Program Files (x86)\\MotionLab3\\_internal\\eoe_service\\IngEcatGateway.exe"
        shell_command_to_issue = "C:\\Windows\\System32\\notepad.exe"
        #print("shell_command_to_issue: " + shell_command_to_issue)

        process = subprocess.Popen([shell_command_to_issue])  # subprocess.Popen doesn't wait for process to terminate
        time.sleep(2.0)

    except:
        #pass
        exceptions = sys.exc_info()[0]
        print("Exceptions: %s" % exceptions)
        traceback.print_exc()
    ##########################################################################################################
    ##########################################################################################################

    ##########################################################################################################
    ##########################################################################################################
    ##########################################################################################################
    while(EXIT_PROGRAM_FLAG == 0):
        time.sleep(0.25)
    ##########################################################################################################
    ##########################################################################################################
    ##########################################################################################################
    print("Exiting main program 'test_program_for_ElevatePythonPermission_ReubenPython3Class.")

##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################